<!DOCTYPE html>
<html lang="en">
  <head>
    <title>HazardVis</title>
    <meta charset="utf-8">
  </head>
    <!-- <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css'> -->
<div class="login">
  <h2 class="active" id = "icon"> 
    <button id = "signinbtn" onclick = "signinFunc()"> Sign in </button> 
  </h2>
  <h2 class="nonactive" id = "icon2"> 
    <button id = "signupbtn" onclick = "signUpFunc()"> Sign up </button>  
  </h2>

  <form id = "form1">
    <input type="input" id = "username" class="text" name="username">
     <span>username</span>
    <br> 
    <br>
    <br>
    <input type="input" id = "pwd" class="text" name="password">
    <span>password</span>
    <br>
    <br>
    <br>
    <button id="signin" type = "button" onclick= "authenticateUser()">Sign In</button>

    <hr>

    <!-- <a href="#">Forgot Password?</a> -->
  </form>

  <form id = "form2">

    
    <input type="text" id = "SUuser" class="text" name="username">
     <span>Enter desired username</span>
    <br> 
    <br>
    <br>
    <input type="password" id = "SUpass" class="text" name="password">
    <span>Enter desired password</span>
    <br>
    <br>

    <button id="signup" type = "button" onclick="createUser()">Sign Up</button>
    <hr>
  </form>
</div>
</html>
<script>
          const form1 = document.getElementById('form1');
      form1.style.display = "block";
      const form2 = document.getElementById('form2');
      form2.style.display = "none";

      // var change_class=document.getElementById("active");
      // change_class.onclick=function()
      // {
      //   var icon=document.getElementById("icon");
      //   icon.className="fa fa-gear";
      // }
      
        function myFunc() {
            location.replace("http://localhost:8080/viewer");
        }

        const btn = document.getElementById('btn');

        function signinFunc(){
          var icon=document.getElementById("icon");
          icon.className="active";

          var icon2=document.getElementById("icon2");
          icon2.className="nonactive";

          if(form1.style.display = "none"){
          form1.style.display = "block";
          form2.style.display = "none";
          }
   
        }
        function signUpFunc(){
          var icon=document.getElementById("icon2");
          icon.className="active";

          var icon2=document.getElementById("icon");
          icon2.className="nonactive";

          form1.style.display = "none";
          form2.style.display = "block";
        
        }

        async function authenticateUser(){
          let us = document.getElementById('username').value;
          let pd = document.getElementById('pwd').value;
          console.log(us);
          console.log(pd);

          //sample fetch request, must post
          let req = await fetch("http://localhost:8080/mongoose/test/find", { // Had an extra slash here
              method: 'PUT',
              json: true, // Tells server this is JSON data
              body: JSON.stringify({
                  user: us,
                  pass: pd
              }), // JSON stringify is needed to send JSON over the network
          })
          .then((response) => response.json())
    .then((data) => {
      console.log('This is data', data);
      if(data.length > 0){
              console.log("worked");
              myFunc();
            }
            else{
              console.log("wrong answer")
             }

    })
          
}
  async function createUser(){
    let us = document.getElementById('SUuser').value;
          let pd = document.getElementById('SUpass').value;
          console.log(us);
          console.log(pd);

          let req = await fetch("http://localhost:8080/mongoose/test/add", { // Had an extra slash here
              method: 'PUT',
              json: true, // Tells server this is JSON data
              body: JSON.stringify({
                  user: us,
                  pass: pd
              }), // JSON stringify is needed to send JSON over the network
          })
          // .then((response) => response.json())
    .then((data) => {
      console.log(data);
      form1.style.display = "block";
      form2.style.display = "none";
      

    })



    
  }
        
      

</script>